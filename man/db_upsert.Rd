% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/upsert.R
\name{db_upsert}
\alias{db_upsert}
\title{Upsert into a DuckLake table using MERGE INTO}
\usage{
db_upsert(
  data,
  schema = "main",
  table,
  by,
  strict = TRUE,
  update_cols = NULL,
  commit_author = NULL,
  commit_message = NULL
)
}
\arguments{
\item{data}{data.frame / tibble}

\item{schema}{Schema name (default "main")}

\item{table}{Table name}

\item{by}{Character vector of key columns used to match rows}

\item{strict}{If TRUE (default), refuse to upsert if duplicates exist in \code{data} for the \code{by} key.}

\item{update_cols}{Controls which columns to update on match:
\itemize{
\item NULL (default): update all columns
\item character(0): insert-only (no updates on match)
\item character vector: update only specified columns
}}

\item{commit_author}{Optional DuckLake commit author}

\item{commit_message}{Optional DuckLake commit message}
}
\value{
Invisibly returns the qualified table name
}
\description{
Upsert into a DuckLake table using MERGE INTO
}
\examples{
\dontrun{
# Basic upsert by id
db_upsert(my_data, table = "products", by = "product_id")

# Composite key
db_upsert(my_data, table = "sales", by = c("region", "date"))

# Update only specific columns
db_upsert(my_data, table = "products", by = "product_id",
          update_cols = c("price", "updated_at"))

# Insert-only (no updates)
db_upsert(my_data, table = "events", by = "event_id",
          update_cols = character(0))

# With commit metadata
db_upsert(my_data, table = "products", by = "product_id",
          commit_author = "jsmith",
          commit_message = "Price update batch")
}
}
